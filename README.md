# lc
 (openwrt系统)使用【lc】命令简化查询 路由器连接表




【lc】命令：
L=list列表的意思 C=conect=连接 （连接列表=List of connections）


创建命令行快捷方式：
ln -s /etc/storage/lc.sh /usr/bin/lc


参数：
-L(大小写英文字母l ：small)：参数内容：为空(null)
例子：lc -l 或 lc -L
说明：简化连接表返回结果输出 仅保留：
协议类型(ipv4/6)、网络类型(tcp/http?/udp)、来源IP、来源端口、目标IP、目标端口、packets封包数量、bytes字节大小

-D(大小写英文字母d ：Debug)：参数内容：为空(null)
例子：lc -d 或 lc -D
说明：打印调试信息：
Debug：来源IP、来源端口、(该行最大)packets封包数量、(该行最大)bytes字节大小、(自定义)packets封包数量(如果有)、(自定义)bytes字节大小(如果有)

-I(大小写英文字母i ：Internet)：参数内容：ipv4/ipv6
例子：lc -i ipv4 或 lc -I ipv6	（大小写功能相同）
说明：查看ipv4连接表 或 ipv6连接表

-N(大小写英文字母n ：Network)：参数内容：tcp/udp/icmp/icmpv6/esp/……
例子：lc -n udp 或 lc -N udp	（大小写功能相同）
说明：查看udp类型的连接表

-p(小写英文字母p ：port)：参数内容：6888
例子：lc -p 8888		（小写p用于单端口）
说明：匹配显示 到本地自定义端口8888的 连接表行条目
-P(大写英文字母P ：ports)：参数内容：6811-6924
例子：lc -P 6811-6924		（大写P用于端口范围）
说明：过滤不显示这些端口/端口范围
      匹配过滤 sport+dport 包含参数内容的端口号(支持端口范围)就过滤该行条目

-B(大小写英文字母b ：bytes)：参数内容：1000000/1500000（任意数字）
例子：lc -b 1000000 或 lc -B 1000000
说明：匹配显示 (取每行bytes最大值)>=自定义bytes参数数字的 连接表行条目

-S(大小写英文字母s ：packets)：参数内容：5000/10000（任意数字）
例子：lc -s 5000 或 lc -S 5000
说明：匹配显示 (取每行packets最大值)>=自定义packets参数数字的 连接表行条目

-ip(大小写功能相同 ：ip)：参数内容：2001:250:250:a000::2600/6.6.6.6
例子：lc -ip 6.6.6.6
说明：匹配显示 包含 参数内容IPV4/IPV6地址的 连接表行条目
支持搜索网段 如：104.234.212.0/24
那么搜索参数就填写104.234.212
支持搜索网段 如：2601:fea6:80dd:022c::/64
那么搜索参数就填写2601:fea6:80dd:022c
由于ipv6地址在连接表条目中显示必须是4个数字一单元所以 需要在不满足4位数
在前面自动补齐0后在搜索（该补全功能由脚本完成）
例子：lc -ip 2a00:7c80:0:243::2
脚本自动补全后搜索执行的内容：
cat /proc/net/nf_conntrack | grep -a "2a00:7c80:0000:0243:0000:0000:0000:0002"

-ips(大小写功能相同 ：ips)：参数内容：/etc/storage/bmd.txt（参数为空时,使用默认路径文件）
例子：lc -ips /etc/storage/bmd.txt
说明：匹配过滤 包含在该文件中的网段/IP,一行一个(为了保证数组循环到结尾 最后一行建议留空行)
当在文件中遇到网段时 自动截取网段前的可用IP作为索引缩写
例如：104.234.212.0/24
过滤索引：104.234.212
并且支持IPV6地址自动补全和网段索引
例如：2601:fea6:80dd:022c::/64
过滤索引：2601:fea6:80dd:022c
例如：2a00:7c80:0:243::2
过滤索引：2a00:7c80:0000:0243:0000:0000:0000:0002
























##### 项目发起人：rer
##### 项目协作者：ChatGPT



